안녕하십니까?
서울시의 초등학교 취학률에 관한 분석을 하고있는 statmania조입니다.
지난주에 이어서 이번주에도 데이터에 관한 분석을 진행해보고자 합니다.

/슬라이드 넘김/
지난주의 분석이 시간과 지역에 따른 취학률의 격차에 관한 것이었다면,
이번주의 주제는 많은 정보를 포함하고 있는 변수를 찾아내는 것이라 할 수 있겠습니다.

/슬라이드 넘김/
먼저 변수선택에 관한 이야기를 하고자 합니다.

/슬라이드 넘김/
요즘 'Big data'라는 말이 유행을 타고 있다는거 알고 계시죠.
그만큼 'Big data'가 통계를 전공하는 이들 뿐만 아니라
다른 학문을 배우는 이들에게도 굉장히 큰 이슈가 되고 있는데요,
커다란 데이터에서 의미있는 결과를 찾아내는 작업은 정말 중요하다고 할 수 있습니다.

/슬라이드 넘김/
그래서 저희 조도 데이터 안에 있는 설명변수들 중 
어느 것이 많은 정보를 내포하고 있는지 찾아보기로 하였습니다.
변수선택을 위한 분석방법에는 여러가지가 존재합니다.

/슬라이드 넘김/
가장 쉽고 대표적인 방법 중 하나가 회귀분석에서의 소위 
Forward selection, Backward Elimination, Stepwise Regression이라 불리는
3가지 방법이 존재하는데
이 방법의 치명적인 단점은 설명변수들끼리 서로 연관성이 있는 경우,
즉, 다중공선성의 문제점을 줄이지 못한다는 점입니다.

/슬라이드 넘김/
그래서 저희는 보시는 것과 같이 PCA라 불리는 주성분 분석을 이용해서
변수선택을 실시해보기로 하였습니다.
이 방법은 실제로도 데이터마이닝에서 자주 쓰이며,
다중공선성의 문제점을 최소화할 수 있다는 장점이 있습니다.
이 분석법을 이용해 지난주 분석에서 취학률에 유의한 영향을 준다고 결론을 얻은
년도, 자치구, 그리고 동에 관한 변수를 제외한 나머지 16개의 설명변수들 중 
의미있다고 판단되는 변수를 선택해볼 것입니다.

/슬라이드 넘김/
이 분석법을 간단히 설명드리면
먼저 주어진 데이터에서 표본평균을 빼는 centering작업을 하고 공분산행렬 S를 구합니다.
만약에 변수들의 단위가 서로 다른 경우에는 상관행렬 R을 구하면 됩니다.
그 다음에 S나 R에 대해서 스펙트럴 분해를 실시하여 고유값 및 고유벡터들을 얻게 되는데
이 고유값과 고유벡터의 개수는 항상 데이터의 변수의 개수와 일치하게 됩니다.
마지막으로 Scree plot 등의 그래프와 고유값의 크기 등을 통해 영향력이 크다고 판단되는
주성분들을 찾아내는 것이죠.

/슬라이드 넘김/
저희가 분석하는 데이터의 설명변수들은 단위가 서로 다릅니다. 
따라서 상관행렬 R을 사용해서 분석할 것이며 분석은 통계 패키지 SAS를 이용하였습니다.

/슬라이드 넘김/
SAS에 저희가 분석할 데이터를 읽어들이고
다음과 같이 코딩을 실시하면 아래와 같은 결과를 줍니다.
여기에서 고유값의 크기가 클수록 주성분의 영향력이 크다고 생각하시면 됩니다.
그렇기 때문에 가장 첫번째 주성분인 제1주성분의 영향력이 항상 크게 됩니다.

/슬라이드 넘김/
다음은 앞에서 구한 고유값들에 대한 고유벡터를 나타낸 것입니다.
이 벡터들은 크기가 1이고 서로 직교한다는 성질이 있으며
이 벡터들을 이용해 주성분을 만들게 됩니다.

/슬라이드 넘김/
이제 의미있는 변수들을 찾아보기 위해 산비탈 그림이라 불리는
Scree plot을 그려보겠습니다. 이 그림을 통해 주성분을 선별하게 되면
데이터의 차원이 축소되는 효과를 얻을 수 있습니다.

/슬라이드 넘김/
다음에 나타난 그림이 Scree plot인데요,
오른쪽의 누적비율에 관한 그래프를 통해서
제1주성분에서 제5주성분까지가 전체 데이터의 70% 이상을 설명하고 있다는 것을
확인할 수 있습니다.
따라서 변수선택에 상위 5개의 주성분을 사용하기로 하였습니다.

/슬라이드 넘김/
이제 데이터의 전체적인 분포형태와 특징을 파악해보기 위한 몇가지 그림을 그려보겠습니다.
16개의 주성분을 모두 사용하는 것은 효율성이 떨어지므로
앞에서 결정한대로 데이터의 정보를 가장 많이 포함하고 있다고 결론지어진 상위 5개의 주성분에 대해서만
실시해보기로 하였습니다.

/슬라이드 넘김/
다음에 나타난 그림은 상위 5개의 주성분에 따른 데이터의 분포를 보여주는 행렬도이며
이를 통해 데이터가 대략적으로 어떻게 분포되어있는지 확인이 가능합니다.

/슬라이드 넘김/
그리고 이 plot은 16개의 설명변수들이 상위 5개의 주성분에 얼마나 많은 영향력을 행사하고 있는지 보여주는
그래프입니다. 이 그래프의 결과가 최종적인 변수선택 시 결정적인 기준이 됩니다.

/슬라이드 넘김/
앞의 plot에서 설명하는 내용을 나누어서 네가지 plot을 그려봤습니다.
앞의 그림보다는 좀 더 쉽게 변수들의 상대적인 위치를 확인해볼 수 있겠습니다.
그림을 살펴보니 제1주성분에는 가정 폭력 발생수,
제2주성분에는 기초 생활 수급자의 수, 제3주성분에는 법정 감염병 환자수가
각각 상대적으로 많은 영향력을 행사하고 있군요.

/슬라이드 넘김/
그리고 나머지 2개의 plot도 더 살펴보면
제4주성분에는 소년, 소녀 가장 수, 마지막으로 제5주성분에는 병원수가
각각 상대적으로 많은 영향력을 행사하고 있음을 알 수 있습니다.

/슬라이드 넘김/
다음 그래프는 영향력이 가장 큰 상위 3개의 주성분에 대한 각 개체의 상대적인 위치를
주성분점수를 통해서 보여주고 있습니다.
색깔이 비슷할수록, 그리고 상대적인 위치가 가까울수록
비슷한 성질을 가진 개체라고 생각하시면 됩니다.

/슬라이드 넘김/
최종적으로 상위 5개의 주성분을 통해서 5개의 설명변수를 선택할 수 있었습니다.
앞의 그래프를 통해서 알아본 결과와 동일한 결과입니다.

/슬라이드 넘김/
최종적으로 주성분 분석을 통해서 저희는 다음과 같이 소년, 소녀 가장수,

/슬라이드 넘김/
기초생활 수급자 tn,

/슬라이드 넘김/
법정 감염병 환자수,

/슬라이드 넘김/
가정 폭력 발생수,

/슬라이드 넘김/
그리고 병원수 이렇게 5개의 설명변수가 영향력이 크다는 것을 알 수 있었습니다.

/슬라이드 넘김/
또한 지난주의 분석과정을 통해서 취학률에 대한 영향력이 있다고 판단된 년도, 

/슬라이드 넘김/
서울시를 구성하는 25개의 자치구,

/슬라이드 넘김/
그리고 자치구들을 구성하는 동에 관한 변수도 추가로 선별하였습니다.

/슬라이드 넘김/
이제 구체적으로 주성분 분석을 통해서 영향력이 높다고 판단된 5개의 설명변수가
과연 실질적으로 초등학교 취학률과는 어떤 연관성이 있는지 알아볼까 합니다.

/슬라이드 넘김/
분석에는 나무모형을 사용할 것입니다.
이 모형의 장점은 통계를 전공하지 않은 일반인이라 할지라도
누구나 쉽게 이해할 수 있는 모형이며
변수 간의 교호작용 관계를 잘 나타내줍니다.
또한 변수가 이산형인지, 연속형인지에 상관없이 사용이 가능하며
계산속도가 빠르기 때문에 대형자료 처리에 용이하다는 특징이 있습니다.

/슬라이드 넘김/
하지만 단점도 존재합니다.
오히려 변수 간의 교호작용이 지나치게 강조될 수 있으며
재귀적인 알고리즘을 사용하므로 결과가 초기 분할에 큰 영향을 받게 됩니다.
그리고 이산형 변수에 대하여 수준이 너무 많으면 결과가 정확하지 않을 수 있고
과대적합된 모형이 작성되기 쉽기 때문에 예측력이 낮을 가능성이 있습니다.
분석은 R을 사용하였습니다.

/슬라이드 넘김/
먼저 개략적인 가장 간단한 나무모형을 만들어봤습니다.
하지만 이 모형은 분할의 기준이 너무 적기 때문에 좀 더 보완을 해야 할 필요성이 느껴집니다.

/슬라이드 넘김/
그래서 저희는 cross-validation 기법을 통해서
좀 더 복잡한 나무모형을 만들고 C.P 분석을 통해 나무모형에서 발생하는 오류값을 최소화하는
크기로 모형을 가지치기해서 최적의 모형을 만들어보기로 하였습니다.
여기에서 주의할 점은 C.P 분석의 결과가 연구자에 따라 항상 같게 나오지는 않는다는 점을
잊지 말아야 하겠습니다. 
cross-validation의 횟수는 100으로 정하고 분석을 실시했습니다.

/슬라이드 넘김/
지금 보시는 그림은 가지치기를 하기 전의 나무모형인데요,
너무 복잡하지도 않고 간단하지도 않은 모형이기 때문에
가지치기 작업을 한다 하더라도 동일한 결과가 나오지 않을까 조심스레 예상을 해봤습니다.

/슬라이드 넘김/
그 다음 적절한 나무모형의 크기를 정하기 위해서 
다음과 같은 출력결과를 얻어봤습니다.
분할의 개수가 커질수록 error의 값이 줄어드는 것을 확인할 수 있습니다.

/슬라이드 넘김/
다음 그림은 앞의 결과에 대한 그래프입니다.
여기에서 오류값이 가장 작을 때의 C.P 통계량 값은 0.01임을 확인할 수 있겠네요.

/슬라이드 넘김/
이제 가지치기 작업을 실시하고 난 다음의 나무모형을 그려보고
결과를 해석해보도록 하겠습니다.

/슬라이드 넘김/
지금 보시는 그림이 가지치기 이후의 결과인데
예상대로 가지치기 이전의 결과와 동일함을 확인할 수 있습니다.
전반적으로 가정 폭력 발생수, 법정 감염병 환자수가 적으며
병원수가 많은 지역의 취학률이 높은 것으로 보여집니다.
그리고 특이한 점은 미리 예상했던 것과는 반대로 기초 생활 수급자의 경우에는
오히려 수치가 많은 지역의 취학률이 대체적으로 높게 나타난다는 것입니다.

/슬라이드 넘김/
저희가 생각하기에 이와 같은 결과의 원인은
다음과 같이 국가에서 정한 기준에 의해 기초 생활 수급자로 등록된 사람에 대해서는
나라차원에서 특별히 교육 등 여러분야에 대한 혜택을 제공하기 때문에
그런 것이 아닐까 여겨집니다.
보시는 것과 같이 우리나라에서는 가정형편이 어려운 학생들에게
교과서비, 학용품비 등을 지급하여 이들이 학업에 열중할 수 있도록
도움을 주고 있습니다.

/슬라이드 넘김/
교육에 대한 것 뿐만 아니라 그 외의 다양한 분야에서도
우리나라에서는 다음과 같이 기초 생활 수급자에 대한 
여러가지 혜택을 제공하고 있었습니다.

/슬라이드 넘김/
다음주부터 마지막주까지는 이제까지의 분석결과를 참고해서
데이터에 대한 시각화를 실시해보고 그동안 실시한 분석을 총정리해볼 것이며
시각화를 실시하는 과정에서 또다른 궁금한 점이 생기게 되면
추가적인 분석도 병행할 예정입니다.

/슬라이드 넘김/
이번주 발표는 여기에서 마무리하겠습니다. 감사합니다.
